---
description: モバイルアプリケーションセキュリティベストプラクティス
languages:
- java
- javascript
- kotlin
- matlab
- perl
- swift
- xml
alwaysApply: false
---

## モバイルアプリケーションセキュリティガイドライン

iOSおよびAndroidプラットフォーム全体で安全なモバイルアプリケーションを開発するための必須セキュリティプラクティス。

### アーキテクチャと設計

最初から安全な設計原則を実装：
- 最小権限と多層防御の原則に従う
- 標準的な安全な認証プロトコルを使用（OAuth2、JWT）
- すべての認証と認可チェックをサーバー側で実行
- アプリとバックエンドサービスに必要な権限のみを要求
- アプリの更新、パッチ、リリースのためのセキュリティ制御を確立
- 信頼され検証済みのサードパーティライブラリとコンポーネントのみを使用

### 認証と認可

セキュリティ決定のためにクライアントを絶対に信頼しない：
- 認証/認可はサーバー側でのみ実行
- デバイスにユーザーパスワードを保存せず、失効可能なアクセストークンを使用
- モバイルアプリに認証情報をハードコーディングしない
- 転送中の認証情報を暗号化
- プラットフォーム固有の安全なストレージを使用（iOS Keychain、Android Keystore）
- パスワードの複雑性を要求し、短いPIN（4桁）を避ける
- セッションタイムアウトとリモートログアウト機能を実装
- 機密操作のために再認証を要求
- 安全なフォールバックを備えたプラットフォームサポートの生体認証を使用

### データストレージとプライバシー

保存時および転送中の機密データを保護：
- プラットフォームAPIを使用して機密データを暗号化、カスタム暗号化を避ける
- ハードウェアベースのセキュリティ機能を活用（Secure Enclave、Strongbox）
- デバイスの内部ストレージにのみプライベートデータを保存
- 必要性に応じてPII収集を最小化し、自動有効期限を実装
- 機密データのキャッシング、ロギング、バックグラウンドスナップショットを避ける
- ネットワーク通信には常にHTTPSを使用

### ネットワーク通信

すべてのネットワーク通信は安全でないと想定：
- すべてのネットワーク通信にHTTPSを使用
- 自己署名証明書のためにSSL証明書検証をオーバーライドしない
- 適切な鍵長を持つ強力な業界標準暗号スイートを使用
- 信頼できるCAプロバイダーによって署名された証明書を使用
- 追加のセキュリティのために証明書ピンニングを検討
- SSL経由で送信される場合でもデータを暗号化
- SMS経由で機密データを送信しない

### コード品質と完全性

開発全体でアプリケーションセキュリティを維持：
- 静的分析ツールを使用して脆弱性を識別
- コードレビュー中にセキュリティを焦点にする
- 既知の脆弱性にパッチを当てるためにすべてのライブラリを最新に保つ
- 本番ビルドでデバッグを無効化
- アプリケーションコードの完全性を検証するコードを含める
- アプリバイナリを難読化
- ランタイムアンチタンパリング制御を実装：
  - デバッグ、フック、コードインジェクションをチェック
  - エミュレーターまたはroot化/jailbreakされたデバイスを検出
  - 実行時にアプリ署名を検証

### プラットフォーム固有のセキュリティ

#### Androidセキュリティ
- コード難読化にAndroidのProGuardを使用
- SharedPreferencesに機密データを保存しない
- バックアップモードを無効化してバックアップ内の機密データを防止
- ハードウェアバッキング（TEEまたはStrongBox）を備えたAndroid Keystoreを使用
- デバイスとアプリの完全性チェックのためにGoogleのPlay Integrity APIを実装

#### iOSセキュリティ
- 機密アクションのためにデバイスロック解除を要求するようにショートカット権限を設定
- 機密機能のためにSiriインテント`requiresUserAuthentication`をtrueに設定
- ディープリンクエンドポイントに認証チェックを実装
- ロック画面で機密ウィジェットコンテンツをマスクする条件ロジックを使用
- 機密データをiOS Keychainに保存、plistファイルには保存しない
- 暗号鍵ストレージにSecure Enclaveを使用
- アプリ完全性検証のためにApp Attest APIを実装
- 永続的なデバイス状態追跡のためにDeviceCheck APIを使用

### テストとモニタリング

包括的なテストを通じてセキュリティ制御を検証：
- 暗号脆弱性評価を含む侵入テストを実施
- セキュリティ機能が期待通り動作することを確認するために自動テストを活用
- セキュリティ機能がユーザビリティを損なわないことを確認
- リアルタイムモニタリングを使用して脅威を検出し対応
- 明確なインシデント対応計画を整備
- 定期的な更新を計画し、必要に応じて強制更新メカニズムを実装

### 入力と出力の検証

インジェクションと実行攻撃を防止：
- すべてのユーザー入力を検証・サニタイズ
- インジェクション攻撃を防ぐために出力を検証・サニタイズ
- ショルダーサーフィンを防ぐためにUIフィールドの機密情報をマスク
- セキュリティ関連のアクティビティについてユーザーに通知（新しいデバイスからのログイン）

OWASP Mobile Application Securityフレームワークから派生したこれらのプラクティスに従うことで、開発フェーズと運用フェーズの両方でモバイルアプリケーションのセキュリティ姿勢を大幅に改善できます。
