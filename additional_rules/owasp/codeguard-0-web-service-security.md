---
description: Webサービスセキュリティ
languages:
- c
- go
- java
- javascript
- php
- python
- ruby
- typescript
- xml
alwaysApply: false
---

## Webサービスセキュリティ

トランスポート保護、認証、入力検証、XML攻撃防止を通じてWebサービスを保護します。

### トランスポートセキュリティ

機密機能やデータを扱うすべてのWebサービス通信は、適切に設定されたTLSを使用する必要があります。TLSは機密性、完全性保護、リプレイ攻撃防御、およびサーバー認証を提供します。

サーバー証明書検証要件:
- 信頼できるプロバイダーによって発行されている
- 有効期限切れや失効していない
- サービスのドメイン名と一致する
- 秘密鍵の所有権が証明されている

### 認証

- Basic認証は避けてください。適切な場合はMutual-TLSによるクライアント証明書認証を使用してください
- クライアントとサーバー間で一貫したエンコーディングスタイルを強制してください

### メッセージ保護

TLSを超える完全性が必要なXMLデータの場合:
- 送信者の秘密鍵によるXMLデジタル署名を使用してください
- 必要に応じて、転送時と保管時の両方の保護のために強力な暗号で機密データを暗号化してください

### 認可

- すべてのWebサービスメソッドとリクエストに対してクライアントを認可してください
- すべてのリクエストで要求されたリソースの権限を確認してください
- 管理機能を通常のサービスエンドポイントから分離してください
- 機密操作（パスワード変更、連絡先情報、支払い指示）にはチャレンジ-レスポンスメカニズムを追加してください

### 入力検証

スキーマ検証:
- XMLスキーマ定義（XSD）に対してSOAPペイロードを検証してください
- すべてのパラメータに対して最大長と文字セットを定義してください
- 固定形式のパラメータ（郵便番号、電話番号）には強力なホワイトリストパターンを使用してください

XML入力のコンテンツ検証:
- 不正なXMLエンティティに対して検証してください
- XML Bomb攻撃に対して検証してください
- 入力検証には強力なホワイトリストを使用してください
- 外部エンティティ攻撃に対して検証してください

### XML攻撃防止

以下に対する保護のためにXMLパーサーを設定してください:
- 再帰的なペイロード
- 過大なペイロード
- XMLエンティティ展開
- 過長な要素名（SOAPアクション）

これらの攻撃に対するパーサーの耐性を検証するテストケースを構築してください。

### 出力保護

WebサービスデータがWebクライアントによって消費される際にクロスサイトスクリプティング（XSS）を防ぐために、適切な出力エンコーディングを適用してください。

### リソース保護

- DoS攻撃を防ぐためにSOAPメッセージサイズを制限してください
- CPUサイクル、メモリ使用量、および同時接続数を制限してください
- 最大メッセージスループットのために設定を最適化してください
- 保存前にSOAP添付ファイルのウイルススキャンを実装してください

### コンプライアンス

セキュリティベースラインのためにWeb Services-Interoperability（WS-I）Basic Profileに準拠していることを確認してください。
