---
description: 脅威モデリングセキュリティ
languages:
- c
- go
- java
- javascript
- kotlin
- php
- python
- ruby
- scala
- swift
- typescript
alwaysApply: false
---

## 脅威モデリングセキュリティ

開発ライフサイクルの早期に、体系的なセキュリティ分析を通じてセキュリティ脅威を識別、分析、軽減する構造化プロセス。

### 脅威モデリングプロセス

脅威モデリングプロセスは4つの重要な質問に答えます：
1. 何に取り組んでいるか？
2. 何が問題になる可能性があるか？
3. それに対して何をするか？
4. 十分な仕事をしたか？

### システムモデリング（何に取り組んでいるか？）

攻撃面とセキュリティ境界を理解するためにシステムの視覚的表現を作成。

データフロー図（DFD）：
- データおよび外部エンティティとのシステム相互作用をモデル化
- 信頼境界、データフロー、データストア、プロセスを識別
- OWASP Threat Dragon、Microsoft Threat Modeling Tool、draw.ioなどのツールを使用
- 複雑なシステムのために複数のDFDを作成（高レベル概要＋詳細サブシステム）
- 更新と参照のためにアクセス可能な形式でDFDを保存

キャプチャすべき主要要素：
- システムと相互作用する外部エンティティ
- コンポーネント間のデータフロー
- データストレージの場所
- プロセス境界と信頼ゾーン
- 認証と認可のポイント

代替アプローチ：
- ドメイン発見のためのブレインストーミングセッション
- 主要な用語と概念の協調的定義
- ビジネスプロセスと依存関係の迅速な識別

### 脅威の識別（何が問題になる可能性があるか？）

STRIDE手法を使用してシステムコンテキスト内の脅威を体系的に識別。

STRIDEカテゴリ：

| 脅威カテゴリ | 侵害するもの | 例 |
|-----------------|----------|----------|
| なりすまし（Spoofing） | 真正性 | 攻撃者が認証トークンを盗んでユーザーになりすます |
| 改ざん（Tampering） | 完全性 | 攻撃者がアプリケーションを悪用して意図しないデータベース更新を実行 |
| 否認（Repudiation） | 否認防止 | 攻撃者がログを操作して行動を隠蔽 |
| 情報漏洩（Information Disclosure） | 機密性 | 攻撃者がユーザーアカウント情報を含むデータベースからデータを抽出 |
| サービス拒否（Denial of Service） | 可用性 | 攻撃者が認証失敗の試行により正規ユーザーをロックアウト |
| 権限昇格（Elevation of Privileges） | 認可 | 攻撃者がJWTを改ざんして役割を変更 |

脅威識別技術：
- システムコンポーネントの各STRIDEカテゴリの体系的レビュー
- 開発チームとセキュリティチームとのブレインストーミングセッション
- キルチェーンやMITRE ATT&CKなどの戦術的アプローチとの統合
- 構造化分析のための脅威モデリングツールの使用

脅威の優先順位付け：
- 識別された脅威の可能性と影響を評価
- 軽減に必要なコストと労力を検討
- リスク対労力比が最も高い脅威に焦点を当てる

### 対応と軽減策（それに対して何をするか？）

これらの戦略を使用して識別された各脅威に対する対応を定義：

対応オプション：
- 軽減：脅威が具現化する可能性を減らす
- 排除：脅威を引き起こす機能またはコンポーネントを削除
- 移転：別のエンティティに責任を移す
- 受容：ビジネス制約のためにリスクを認識するが行動を取らない

軽減要件：
- 実装可能な実行可能な軽減戦略を開発
- 軽減策をテスト可能な要件として文書化
- ガイダンスのためにOWASP ASVSやMITRE CWEなどの標準を参照
- カテゴリまたは個別脅威レベルで軽減策を適用
- 軽減策がシステムに組み込まれ、理論的でないことを確保

### レビューと検証（十分な仕事をしたか？）

ステークホルダーレビューを通じて脅威モデルの完全性と効果を検証。

レビュー基準：
- モデルは実際のシステムを正確に反映しているか？
- すべての適用可能な脅威が識別されたか？
- 各脅威に対して対応戦略が定義されたか？
- 軽減戦略はリスクを許容レベルに削減するか？
- 脅威モデルは正式に文書化されアクセス可能か？
- 軽減策はテストされ効果を測定できるか？

レビュー参加者：
- 開発チーム
- セキュリティチーム
- アーキテクチャチーム
- プロダクトステークホルダー
- 運用チーム

### 開発プロセスとの統合

SDLCに脅威モデリングをシームレスに統合：
- 設計フェーズ中に初期脅威モデリングを実施
- システムアーキテクチャが変更されたときに脅威モデルを更新
- 機能開発ワークフローに脅威モデリングを含める
- オプションの追加ではなく標準的な開発ステップとして扱う
- システムの進化とともにモデルを維持・改良

開発チームの考慮事項：
- 開発者にセキュリティトレーニングを提供
- 脅威モデリングセッションにセキュリティ専門家を含める
- 脅威識別を簡素化・自動化するツールを使用
- 開発組織内でセキュリティ文化を促進
- チーム間の協力とコミュニケーションを確立

ツールと技術：
- 協調的脅威モデリングのためのOWASP Threat Dragon
- 構造化分析のためのMicrosoft Threat Modeling Tool
- threat-modeling-as-codeアプローチのためのOWASP pytm
- 図作成のための脅威モデリングライブラリを備えたdraw.io
- STRIDE、PASTA、LINDDUN、OCTAVE、VAST手法

### 実装ガイドライン

1. 設計フェーズの早期に脅威モデリングを開始しSDLCに統合
2. 信頼境界とデータフローを示す包括的なデータフロー図を作成
3. STRIDE手法を体系的に適用して脅威を識別
4. 可能性、影響、軽減コストに基づいて脅威を優先順位付け
5. 実行可能でテスト可能な軽減要件を開発
6. レビューにセキュリティ専門家と機能横断的ステークホルダーを関与
7. 脅威モデルを文書化しアーティファクトをアクセス可能に保存
8. システムアーキテクチャまたは機能が変更されたときに脅威モデルを更新
9. プロセスをサポートし合理化するために適切なツールを使用
10. 開発チーム全体でセキュリティ意識と協力を促進
