---
description: 脆弱な依存関係管理
languages:
- c
- go
- javascript
- r
- xml
alwaysApply: false
---

## 脆弱な依存関係管理

自動スキャン、適切なテスト、体系的な修復アプローチを通じて、サードパーティ依存関係のセキュリティ脆弱性を検出・軽減。

### 自動検出

複数の脆弱性ソースをカバーするツールを使用して、プロジェクト開始時から脆弱性スキャンを統合：
- CVEデータベース（NIST National Vulnerability Database）
- 完全開示ソース（メーリングリスト、Exploit-DB）
- プロバイダー固有の脆弱性フィード

推奨ツール：
- OWASP Dependency Check（Java、.NET、Python、Ruby、PHP、Node.js、C/C++の実験的サポート）
- NPM Audit（Node.js、JavaScript）
- OWASP Dependency Track（組織全体の管理）

### 修復ケース

ケース1 - パッチ適用済みバージョンが利用可能：
1. テスト環境で依存関係バージョンを更新
2. 自動テストを実行して機能を検証
3. テストが成功した場合：本番にデプロイ
4. テストが失敗した場合：API変更のためにアプリケーションコードを更新またはプロバイダーに非互換性を報告

ケース2 - パッチが遅延、プロバイダーが回避策を提供：
1. 利用可能な場合はプロバイダーの回避策を適用
2. プロバイダーが影響を受ける関数をリストしている場合、保護ラッパーを追加
3. テスト環境で回避策を検証

RCE脆弱性のための保護ラッパーの例：
```java
public void callFunctionWithRCEIssue(String externalInput){
    //Apply input validation on the external input using regex
    if(Pattern.matches("[a-zA-Z0-9]{1,50}", externalInput)){
        //Call the flawed function using safe input
        functionWithRCEIssue(externalInput);
    }else{
        //Log the detection of exploitation
        SecurityLogger.warn("Exploitation of the RCE issue XXXXX detected !");
        //Raise an exception leading to a generic error send to the client...
    }
}
```

ケース3 - パッチが利用できない：
1. CVE説明を分析して脆弱性タイプを理解（SQLインジェクション、XSS、XXE等）
2. 脆弱な依存関係を呼び出すすべてのアプリケーションコードを識別
3. 脆弱性タイプに基づいて代償的制御を実装
4. 保護の効果を検証するユニットテストを作成
5. オープンソース依存関係の場合：パッチの作成と貢献を検討

ケース4 - 以前は未知の脆弱性を発見：
1. 脆弱性の詳細をプロバイダーに通知
2. プロバイダーが協力する場合：ケース2のアプローチに従う
3. プロバイダーが無反応の場合：ケース3のアプローチに従う

### 依存関係分析

推移的依存関係：可能な場合は直接依存関係に作用します。推移的依存関係の変更には複雑な依存関係チェーンの理解が必要で、アプリケーションの安定性に影響を与える可能性があります。

依存関係管理ツールを使用して以下を識別：
- 直接依存関係対推移的依存関係の関係
- 脆弱なコンポーネントを使用するすべてのコードパス
- 潜在的な脆弱性の影響範囲

### テストと検証

以下をカバーする包括的な自動テストを維持：
- 影響を受ける依存関係を使用する機能
- 軽減策として追加されたセキュリティ制御
- 更新時の回帰検出

依存関係更新の前後でテストを実行して以下を確保：
- アプリケーション機能が intact のまま
- セキュリティ軽減策が効果的
- 新しい脆弱性が導入されていない

### リスク管理

以下を含むすべての脆弱性決定を文書化：
- 技術分析とCVSSスコアリング
- 選択された軽減アプローチと根拠
- テスト結果と検証ステップ
- ビジネス正当化によるリスク受容決定

徹底的な技術分析後、Chief Risk Officerにリスク受容決定をエスカレート。

### 継続的モニタリング

CI/CDパイプラインに継続的な依存関係スキャンを実装：
- すべてのビルドでスキャン
- 高深刻度の脆弱性に対してビルドを失敗
- セキュリティチームレビューのためのレポート生成
- 修復の進捗とコンプライアンスを追跡

異なる脆弱性開示方法を処理するために、偽陽性フラグ設定と複数の信頼できる入力ソースをサポートするツールを選択。

### 予防ガイドライン

- プロジェクト開始時から依存関係スキャンを開始
- 外部制御よりソース（アプリケーションまたは依存関係）で脆弱性を修正することを優先
- 依存関係を定期的に更新
- メンテナンスステータスとコミュニティアクティビティの依存関係をモニタリング
- ライブラリ選択時に依存関係の複雑性と推移的依存関係の数を検討
