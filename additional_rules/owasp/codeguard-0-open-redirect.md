---
description: オープンリダイレクトの防止 - フィッシング攻撃を防ぐためのユーザー制御リダイレクトの安全な処理
languages:
- c
- javascript
- php
- typescript
- vlang
alwaysApply: false
---

# オープンリダイレクトを避ける

- ユーザー入力をリダイレクト先として直接使用しない（例：Node.js/Expressの`res.redirect(userInput)`）
- リダイレクトがユーザー入力によって制御される場合：
    - ローカルパスのみを許可する（`/`で始まり、`http:`のようなプロトコルを含まない必要があります）
    - または：信頼されたドメインの厳格な許可リストに存在する宛先のみを許可する
- URLは単純な部分文字列チェックではなく、堅牢なライブラリを使用して解析および検証する必要があります
- 許可リストに`*.example.com`のようなワイルドカードドメインを許可しないでください
- リダイレクトを使用する際は、ルールがどのように適用されているかを文書化するため、明示的なコードコメントを追加してください