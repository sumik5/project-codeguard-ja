---
description: 暗号化鍵管理セキュリティ
languages:
- c
- go
- java
- javascript
- kotlin
- python
- ruby
- swift
- typescript
alwaysApply: false
---

## 鍵管理セキュリティガイドライン

アプリケーションにおける安全な暗号化鍵管理のための重要なプラクティス。

### 鍵生成

暗号化鍵は、少なくともFIPS 140-2準拠の暗号化モジュール内で生成する必要があります。鍵生成モジュールが必要とするランダム値は、そのモジュール内で実装されたランダムビット生成器を使用してモジュール内で生成される必要があります。

保護のため、ソフトウェア暗号化モジュールよりもハードウェア暗号化モジュールが推奨されます。

### 鍵保存

- 鍵は、揮発性メモリと永続メモリの両方で保護される必要があり、理想的にはセキュアな暗号化モジュール内で処理されます
- 鍵は決して平文形式で保存すべきではありません
- すべての鍵は、ハードウェアセキュリティモジュール（HSM）または隔離された暗号化サービスなどの暗号化ボルトに保存することを確認します
- オフラインデバイス/データベースに鍵を保存する場合、エクスポート前に鍵暗号化鍵（KEK）を使用して鍵を暗号化します
- KEKの長さとアルゴリズムは、保護される鍵と同等以上の強度である必要があります
- 標準的なアプリケーションレベルのコードが、暗号化鍵を直接読み取ったり使用したりしないことを確認します

### 鍵の使用と分離

NISTによると、一般的に、単一の鍵は1つの目的（暗号化、認証、鍵ラッピング、乱数生成、デジタル署名など）のみに使用されるべきです。

鍵分離の理由：
- 2つの異なる暗号化プロセスに同じ鍵を使用すると、提供されるセキュリティが弱まる可能性があります
- 鍵の使用を制限することで、鍵が侵害された場合に発生する可能性のある損害を制限します
- 鍵の一部の用途は互いに干渉します

### メモリ管理

長時間メモリに保存された鍵は「焼き付く」可能性があります。これは、頻繁に更新されるコンポーネントに鍵を分割することで緩和できます。

鍵または証明書の生成、登録、配布システムに必要なメモリメディアの破損から回復するための計画を立てます。

### 鍵のバックアップとリカバリ

失われた暗号化鍵で暗号化されたデータは決して回復できません。したがって、アプリケーションがセキュアな鍵バックアップ機能を組み込むことが不可欠です。

鍵をバックアップする際は、鍵を保存するために使用されるデータベースが、少なくともFIPS 140-2検証済みモジュールを使用して暗号化されていることを確認してください。

デジタル署名の実行に使用される鍵は決してエスクローしませんが、暗号化をサポートする鍵をエスクローする必要性を検討してください。

### トラストストアセキュリティ

- サードパーティのルート証明書の注入に対してトラストストアを保護する制御を設計します
- トラストストアに保存されているオブジェクトに整合性制御を実装します
- 認証と認可なしでトラストストア内に保持されている鍵のエクスポートを許可しません
- 鍵マテリアルのエクスポートのための厳格なポリシーと手順を設定します
- トラストストアを更新するためのセキュアなプロセスを実装します

### 鍵セキュリティ要件

- FIPS 140-2検証済みモジュールまたはHSMでのみ鍵を生成します
- 適切な鍵長を持つNIST承認アルゴリズムを使用します
- 異なる暗号化目的で鍵を再利用しないでください
- 鍵のローテーションとライフサイクル管理を実装します
- 完全前方秘匿性（Perfect Forward Secrecy）のためにエフェメラル鍵を使用します
- すべての鍵アクセス操作を監視および監査します
- サードパーティ組織によって適切に保守および検証されている評判の良い暗号化ライブラリのみを使用します