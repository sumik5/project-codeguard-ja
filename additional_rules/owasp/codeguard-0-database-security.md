---
description: データベースセキュリティベストプラクティス
languages:
- c
- java
- javascript
- python
- sql
- yaml
alwaysApply: false
---

## データベースセキュリティガイドライン

このルールは、データ侵害と不正アクセスから保護するためのSQLおよびNoSQLデータベースの安全な設定についてアドバイスします：

- バックエンドデータベース保護
  - データベースサーバーを他のシステムから隔離し、ホスト接続を制限します。
  - 可能な場合、ネットワーク（TCP）アクセスを無効化し、ローカルソケットファイルまたは名前付きパイプを使用します。
  - 適切な場合、データベースをlocalhostのみにバインドするよう設定します。
  - ファイアウォールルールで特定のホストへのネットワークポートアクセスを制限します。
  - データベースサーバーをアプリケーションサーバーから隔離された別のDMZに配置します。
  - シッククライアントからバックエンドデータベースへの直接接続を決して許可しません。

- トランスポート層セキュリティ
  - データベースが暗号化された接続のみを許可するよう設定します。
  - データベースサーバーに信頼されたデジタル証明書をインストールします。
  - クライアント接続には、最新の暗号（AES-GCM、ChaCha20）を伴うTLSv1.2+を使用します。
  - クライアントアプリケーションでデジタル証明書の有効性を検証します。
  - 初期認証だけでなく、すべてのデータベーストラフィックが暗号化されていることを確保します。

- セキュアな認証設定
  - ローカルサーバー接続を含め、常に認証を要求します。
  - 強力でユニークなパスワードでアカウントを保護します。
  - アプリケーションまたはサービスごとに専用アカウントを使用します。
  - 必要最小限の権限のみを設定します。
  - アカウントと権限を定期的にレビューします。
  - アプリケーションが廃止されたときにアカウントを削除します。
  - スタッフが退職したとき、または侵害が疑われるときにパスワードを変更します。

- データベース認証情報の保存
  - アプリケーションのソースコードに認証情報を決して保存しません。
  - Webルート外の設定ファイルに認証情報を保存します。
  - 認証情報アクセスに適切なファイル権限を設定します。
  - ソースコードリポジトリに認証情報ファイルを決してチェックインしません。
  - 利用可能な場合、組み込み機能を使用して認証情報の保存を暗号化します。
  - 環境変数またはシークレット管理ソリューションを使用します。

- セキュアな権限管理
  - すべてのデータベースアカウントに最小権限の原則を適用します。
  - 組み込みのroot、sa、またはSYSアカウントを使用しません。
  - アプリケーションアカウントに管理者権限を付与しません。
  - アカウント接続を許可されたホストのみに制限します。
  - 開発、UAT、本番環境で別々のデータベースとアカウントを使用します。
  - 必要な権限のみを付与します（必要に応じてSELECT、UPDATE、DELETE）。
  - 権限昇格を防ぐため、アカウントをデータベース所有者にしません。
  - 必要に応じて、テーブルレベル、カラムレベル、行レベルの権限を実装します。

- データベース設定とハードニング
  - 必要なセキュリティアップデートとパッチを定期的にインストールします。
  - 低特権ユーザーアカウントでデータベースサービスを実行します。
  - デフォルトアカウントとサンプルデータベースを削除します。
  - トランザクションログをメインデータベースファイルとは別のディスクに保存します。
  - 適切な権限で定期的な暗号化データベースバックアップを設定します。
  - 不要なストアドプロシージャと危険な機能を無効化します。
  - データベース活動の監視とアラートを実装します。

- プラットフォーム固有のハードニング
  - SQL Server: xp_cmdshell、CLR実行、SQL Browserサービス、混合モード認証（必要な場合を除く）を無効化します。
  - MySQL/MariaDB: mysql_secure_installationを実行し、ユーザーのFILE特権を無効化します。
  - PostgreSQL: PostgreSQLセキュリティドキュメントのガイドラインに従います。
  - MongoDB: MongoDBセキュリティチェックリストの要件を実装します。
  - Redis: Redisセキュリティガイドの推奨事項に従います。

まとめ：
データベースシステムを隔離し、暗号化接続を強制し、強力な認証を実装し、シークレット管理を使用して認証情報を安全に保存し、最小権限の原則を適用し、データベース設定を堅牢化し、定期的なセキュリティアップデートと監視を維持します。