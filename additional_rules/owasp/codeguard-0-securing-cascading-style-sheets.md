---
description: CSS（Cascading Style Sheets）のセキュリティ保護
languages:
- c
- javascript
- typescript
alwaysApply: false
---

## CSS（Cascading Style Sheets）のセキュリティ保護

CSSファイルがアプリケーションの機能、ユーザーロール、機密性の高い機能を攻撃者の偵察活動に晒すことを防止します。

### セキュリティリスク

#### リスク1: CSSセレクタによる情報漏洩
攻撃を試みる前にアプリケーションの機能を学習するため、攻撃者はCSSファイルを調査します。ロールベースのセレクタを含むグローバルCSSファイルは以下を明らかにします：
- 異なるユーザーロールと権限
- 利用可能な機能
- アプリケーション構造と機密性の高いエンドポイント

問題のあるセレクタの例：
- `.profileSettings`
- `.addUsers`
- `.deleteUsers`
- `.exportUserData`
- `.addNewAdmin`

#### リスク2: 説明的なセレクタ名
読みやすいセレクタ名は、攻撃者がCSSクラスを実際のアプリケーション機能にマッピングするのを容易にします：
- `.changePassword`
- `.oldPassword`
- `.newPassword`
- `.confirmNewPassword`

### 防御メカニズム

#### 防御1: アクセス制御レベル別にCSSを分離
- ロールごとに個別のCSSファイルを作成（StudentStyling.CSS、AdministratorStyling.CSS）
- 適切なアクセス制御レベルを持つユーザーのみがCSSファイルにアクセスできるよう制限
- CSSファイルを提供する前にサーバーサイド検証を実装
- 不正なCSSファイルアクセス試行（強制ブラウジング）をログに記録し、アラートを発行
- 認証済みユーザーが他のロール用のCSSファイルにアクセスできないようにする

#### 防御2: 識別情報の削除
- 特定のセレクタの必要性を減らすため、ページ間で一貫したスタイリングを使用
- 複数のページに適用される汎用的なCSSルールを記述
- 機能を明らかにしないHTML要素をターゲットとするCSSセレクタを作成

説明的なセレクタを変換：
```
// この明示的なセレクタの代わりに:
#UserPage .Toolbar .addUserButton

// 曖昧な構造的ターゲティングを使用:
#page_u header button:first-of-type
```

ビルド時およびランタイム難読化ツール：
- JSS（CSS in JS）のminifyオプションで`.c001`、`.c002`のようなクラス名を生成
- CSS ModulesのmodulesとlocalIdentNameオプションで難読化
- .Net Blazor CSS Isolationで`button.add[b-3xxtam6d07]`のようなスコープ付きセレクタを作成
- CSSライブラリ（Bootstrap、Tailwind）で特定のセレクタの必要性を削減

#### 防御3: ユーザーコンテンツ内の悪意あるCSSを防止
- ユーザーが作成したHTMLコンテンツを検証してサニタイズ
- ユーザー生成コンテンツで許可されるCSSスタイルを制限
- アップロードされたHTMLが意図しない目的でスタイルを使用することを防止
- CSSがクリックジャッキング攻撃に使用される可能性があることを認識する（ページ上のどこをクリックしても悪意あるWebサイトがロードされる）

### 実装ガイドライン

1. ユーザーロールとアクセスレベル別にCSSファイルをセグメント化
2. CSSリソースを提供する前にアクセス制御検証を実装
3. ビルド時ツールを使用してクラス名とセレクタを難読化
4. 機能固有の名前よりも構造的および要素ベースのセレクタを優先
5. CSSフレームワークを活用してカスタムセレクタを最小化
6. スタイルを含むユーザー生成HTMLコンテンツをサニタイズして制限
7. ロール固有のCSSファイルへの不正アクセス試行を監視してログに記録
8. すべてのユーザーロールのセレクタを含むグローバルCSSファイルを避ける
9. 機能を明らかにしない汎用的で説明的でないクラス名を使用
10. ロール間の適切な分離を確保するためにCSSアクセス制御をテスト
