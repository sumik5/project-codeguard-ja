---
description: RESTful Webサービスセキュリティ評価ガイドライン
languages:
- c
- go
- java
- javascript
- python
- ruby
- typescript
- xml
- yaml
alwaysApply: false
---

## RESTful Webサービスセキュリティ評価ガイドライン

RESTful Webサービスのセキュリティテストと評価のための必須プラクティス。攻撃対象領域の特定とテスト方法論に焦点を当てます。

### RESTセキュリティの課題の理解

RESTful Webサービスには独特のセキュリティテストの課題があります:

- クライアントアプリケーションが利用可能なすべてのサービス機能を利用するとは限らないため、攻撃対象領域がアプリケーションの検査では見えない
- パラメータが標準のクエリ文字列ではなく、URLパス、カスタムヘッダー、または構造化データに埋め込まれている可能性がある
- JSON/XML構造の大きなパラメータセットがテストの複雑さを大幅に増加させる
- カスタム認証メカニズムはリバースエンジニアリングが必要で、標準テストツールでは動作しない可能性がある
- 正式なドキュメントの欠如が包括的なテストを困難にする

### RESTサービスの特性

セキュリティ評価に影響を与える主要なプロパティ:

- 主要な操作はHTTPメソッド（GET、POST、PUT、DELETE）を使用
- URLセグメントやカスタムヘッダーを含む非標準のパラメータ位置
- JSONまたはXML形式を使用した構造化パラメータとレスポンス
- セキュリティトークンを使用したカスタム認証とセッション管理
- 従来のログインシーケンスを持たないマシン間通信

### 攻撃対象領域の発見

#### ドキュメントベースの発見

包括的なカバレッジのためにサービス情報を取得:

- 利用可能な場合は正式なサービス記述（WSDL 2.0、WADL）
- 開発者ガイドとAPIドキュメント
- アプリケーションのソースコードまたは設定ファイル
- フレームワーク設定ファイル（特に.NET）がRESTサービス定義を明らかにする可能性がある

#### プロキシベースのリクエスト収集

完全なHTTPインタラクションを収集するために有能なプロキシツールを使用:

- URLだけでなく、ヘッダーとボディコンテンツを含む完全なリクエストをキャプチャ
- RESTサービスはGETパラメータ以上のものを利用するため、完全なリクエスト分析が必要
- 動的なクライアント側のアクティベーションは検査のための可視リンクを提供しない可能性がある

#### パラメータ識別テクニック

収集されたリクエストを分析して非標準パラメータを識別:

- 異常なHTTPヘッダーはヘッダーベースのパラメータを示すことが多い
- 繰り返しパターン（日付、数値、IDのような文字列）を持つURLセグメントはURL埋め込みパラメータを示唆
- 最終セグメントに拡張子がないURL（特に他のセグメントに拡張子がある場合）
- 物理ディレクトリではなくパラメータを示す、多くの異なる値を持つ高度に変化するURLセグメント
- JSON、XML、またはカスタム形式の構造化パラメータ値

### パラメータ検証方法

パス要素とパラメータを区別:

- 疑わしいパラメータ値を無効な入力に設定
- Webサーバーは無効なパス要素に対して404を返す
- アプリケーションは無効なパラメータ値に対してアプリケーションレベルのエラーメッセージを返す
- このテクニックはパラメータ識別の確認に役立つが、すべてのケースで機能するわけではない

### ファジング最適化戦略

収集されたパラメータ値を分析してテストを最適化:

- 有効な値パターンと無効な値パターンを識別
- 限界的な無効値（例: 正の整数に対するゼロ）にファジングを集中
- 現在のユーザーの割り当て範囲を超えてテストするシーケンスを識別
- パラメータの関係と依存関係を理解

### 認証メカニズムの処理

カスタム認証の課題に対処:

- カスタムトークンベース認証をリバースエンジニアリング
- ファジングツールが認証メカニズムを適切にエミュレートすることを保証
- マシン間通信におけるセッション管理の違いを考慮
- 認証バイパスと権限昇格シナリオをテスト

### テスト方法論のベストプラクティス

RESTサービス評価への体系的なアプローチ:

- ドキュメントレビューと動的分析を組み合わせる
- 完全なHTTPトランザクションを処理できるプロキシツールを使用
- パラメータの位置を体系的に識別して検証
- 観察されたパラメータパターンに基づいてファジングを最適化
- テスト全体で認証コンテキストを維持
- 発見されたエンドポイントとパラメータ構造を文書化

### ドキュメントと正式な記述

適切なドキュメントによる評価効率の向上:

- 正式なサービス記述（WADL、WSDL 2.0）の使用を推奨
- セキュリティ評価者のための包括的な開発者ガイドを提供
- すべてのエンドポイント、パラメータ、期待されるデータ形式を文書化
- 認証と認可の要件を含める

### セキュリティテストカバレッジ

包括的なセキュリティ評価を確保:

- 各エンドポイントでサポートされるすべてのHTTPメソッドをテスト
- すべてのパラメータ位置（URL、ヘッダー、ボディ）の入力処理を検証
- 認証と認可メカニズムをテスト
- レート制限とサービス拒否保護を評価
- 適切なエラー処理と情報漏洩防止を検証

この評価方法論は、従来のWebアプリケーションと比較したRESTful Webサービス特有の課題に対処することで、セキュリティ脆弱性の特定に役立ちます。
