---
description: 依存関係とサプライチェーンセキュリティ（固定、SBOM、プロビナンス、整合性、プライベートレジストリ）
languages:
- docker
- javascript
- yaml
alwaysApply: false
---

## 依存関係とサプライチェーンセキュリティ

選択と固定からプロビナンス、スキャン、迅速な対応まで、エコシステム全体でサードパーティリスクを制御。

### ポリシーとガバナンス
- 許可リストに登録されたレジストリとスコープを維持。信頼できないソースからの直接インストールを禁止。
- ロックファイルとバージョン固定を要求。イメージとベンダー化されたアセットにはダイジェスト固定を優先。
- アプリ/イメージのSBOMを生成。成果物と共に保存。プロビナンス（SLSA、Sigstore）を証明。

### パッケージハイジーン（npm焦点、他にも適用可能）
- 定期的な監査（`npm audit`、エコシステムSCA）とパッチ適用。深刻度別のSLAを強制。
- 決定論的ビルドを使用：CI/CDで`npm ci`（`npm install`ではない）を使用。ロックファイルの一貫性を維持。
- 可能な限り、インストール時に実行されるインストールスクリプトを避ける。リスクをレビュー。
- `.npmrc`を使用してプライベートレジストリをスコープ化。ワイルドカードレジストリを避ける。整合性検証を有効化。
- 公開時にアカウント2FAを有効化。

### 開発プラクティス
- 依存関係のフットプリントを最小化。未使用のパッケージを削除。些細なタスクにはstdlib/ファーストパーティを優先。
- タイポスクワッティングとプロテストウェアから保護：メンテナーを固定し、リリースを監視し、プロビナンスチェックを使用。
- ハーメティックビルド：必要でない限り、コンパイル/パッケージング段階でネットワークを使用しない。真正性チェックでキャッシュ。

### CI/CD統合
- ゲートでSCA、SAST、IaCスキャンを実施。クリティカルな問題で失敗。補完制御を伴うオーバーライドには承認を要求。
- 成果物に署名。デプロイ時に署名を検証。アドミッションでポリシーを強制。

### 脆弱性管理
- パッチ済み脆弱性の場合：更新をテストしてデプロイ。APIの破壊的変更を文書化。
- 未パッチ脆弱性の場合：CVEタイプに基づいて補完制御（入力検証、ラッパー）を実装。推移的な回避策より直接依存関係の修正を優先。
- リスク判断を文書化。ビジネス正当化を伴う適切な権限への受容をエスカレーション。

### インシデント対応
- 迅速なロールバックを維持。侵害されたパッケージを分離。ロールアウトをスロットル。ステークホルダーに通知。
- 脅威インテリジェンスフィード（例：npm advisories）を監視。クリティカルなCVEに対して自動的にチケットを作成。

### 実装チェックリスト
- ロックファイルが存在。整合性チェックが有効。プライベートレジストリが設定済み。
- SBOM + プロビナンスが保存済み。デプロイ前に署名が検証済み。
- テストとレビューゲートを伴う自動化された依存関係更新。
- 高深刻度の脆弱性がSLA内で修正、または緩和および文書化済み。
