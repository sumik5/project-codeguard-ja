---
description: ハードコードされた認証情報の禁止
languages: []
alwaysApply: true
---

# ハードコードされた認証情報の禁止

機密情報、パスワード、APIキー、トークン、その他の認証情報をソースコードに直接保存することを決して行わないでください。

コードベースをパブリックで信頼できないものとして扱います。ソースコードに現れる認証情報は侵害されたものとして扱い、安全な代替手段を通じて処理する必要があります。

#### これらの種類の値を決してハードコードしないでください：

パスワードと認証：
- データベースパスワード、ユーザーパスワード、管理者パスワード
- APIキー、シークレットキー、アクセストークン、リフレッシュトークン
- 秘密鍵、証明書、署名鍵
- 認証情報を含む接続文字列
- OAuthクライアントシークレット、Webhookシークレット
- 外部サービスへのアクセスに使用できるその他の認証情報


#### 認識パターン - これらの形式を見つける方法を学ぶ

決してハードコードしてはいけない一般的なシークレット形式：

- AWSキー：`AKIA`、`AGPA`、`AIDA`、`AROA`、`AIPA`、`ANPA`、`ANVA`、`ASIA`で始まる
- Stripeキー：`sk_live_`、`pk_live_`、`sk_test_`、`pk_test_`で始まる
- Google API：`AIza`で始まり35文字続く
- GitHubトークン：`ghp_`、`gho_`、`ghu_`、`ghs_`、`ghr_`で始まる
- JWTトークン：ドットで区切られた3つのbase64セクション、`eyJ`で始まる
- 秘密鍵ブロック：`-----BEGIN`と`-----END PRIVATE KEY-----`の間のテキスト
- 接続文字列：`mongodb://user:pass@host`のような認証情報を含むURL

コード内の警告サイン：
- 以下を含む変数名：`password`、`secret`、`key`、`token`、`auth`
- 何であるか明確でない長いランダムに見える文字列
- 認証コード近くのBase64エンコード文字列
- 外部サービスへのアクセスを許可する文字列

このルールがどのように適用されたか、なぜ適用されたかを常に説明する必要があります。
